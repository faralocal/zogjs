!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).ZogLibrary={})}(this,function(e){"use strict";let t=null;class r{constructor(){this.subscribers=new Set}depend(){t&&this.subscribers.add(t)}notify(){this.subscribers.forEach(e=>e())}}function n(e){t=e,e(),t=null}e.createApp=function(e){let t={};const r=(e,r=t)=>{try{const t=Object.keys(r),n=t.map(e=>r[e]&&r[e]._isRef?r[e].value:r[e]);return new Function(...t,`return ${e}`)(...n)}catch(n){return""}},o=(e,i=t)=>{if(e){if(3===e.nodeType){const t=e.textContent;return void(t.match(/{{\s*(.*?)\s*}}/)&&n(()=>{e.textContent=t.replace(/{{\s*(.*?)\s*}}/g,(e,t)=>r(t,i))}))}if(1===e.nodeType){if(e.hasAttribute("z-if")){const t=e.getAttribute("z-if"),o=document.createComment("z-if");e.parentNode.insertBefore(o,e);let s=e.nextElementSibling,c=s&&s.hasAttribute("z-else")?s:null;if(c&&c.remove(),n(()=>{r(t,i)?(document.contains(e)||o.parentNode.insertBefore(e,o),c&&document.contains(c)&&c.remove()):(e.remove(),c&&o.parentNode.insertBefore(c,o))}),!r(t,i))return}if(e.hasAttribute("z-for")){const t=e.getAttribute("z-for"),[c,a]=t.split(" in ").map(e=>e.trim()),u=e.parentNode,f=document.createComment("z-for");u.insertBefore(f,e),e.remove();let l=[];return void n(()=>{l.forEach(e=>e.remove()),l=[];const t=r(a,i);Array.isArray(t)&&t.forEach((t,r)=>{const n=e.cloneNode(!0);n.removeAttribute("z-for"),u.insertBefore(n,f),l.push(n);const a={...i,[c]:{value:t,_isRef:!0},index:r};Array.from(n.childNodes).forEach(e=>o(e,a)),s(n,a)})})}s(e,i),Array.from(e.childNodes).forEach(e=>o(e,i))}}},s=(e,t)=>{Array.from(e.attributes).forEach(o=>{const{name:s,value:i}=o;if("z-model"===s){e.removeAttribute("z-model");const o=e.getAttribute("type"),s=e.tagName.toLowerCase();"checkbox"===o?(e.addEventListener("change",()=>{t[i]&&(t[i].value=e.checked)}),n(()=>e.checked=r(i,t))):"radio"===o?(e.addEventListener("change",()=>{e.checked&&t[i]&&(t[i].value=e.value)}),n(()=>{e.checked=r(i,t)===e.value})):"select"===s?(e.addEventListener("change",e=>{t[i]&&(t[i].value=e.target.value)}),n(()=>e.value=r(i,t))):(e.addEventListener("input",e=>{t[i]&&(t[i].value=e.target.value)}),n(()=>{e.value=r(i,t)}))}if(s.startsWith("@")){const n=s.slice(1);e.removeAttribute(s);const o=e=>{const n=t[i];"function"==typeof n?n(e):r(i,t)};e.addEventListener(n,o)}if(s.startsWith(":")){const o=s.slice(1);e.removeAttribute(s),n(()=>{const n=r(i,t);if("style"===o&&"object"==typeof n)Object.assign(e.style,n);else if("class"===o&&"object"==typeof n){const t=Object.keys(n).filter(e=>n[e]).join(" ");e.setAttribute("class",t)}else e.setAttribute(o,n)})}"z-text"===s&&(e.removeAttribute("z-text"),n(()=>e.textContent=r(i,t))),"z-html"===s&&(e.removeAttribute("z-html"),n(()=>e.innerHTML=r(i,t))),"z-show"===s&&(e.removeAttribute("z-show"),n(()=>{e.style.display=r(i,t)?"":"none"}))})};return{mount(r){const n=document.querySelector(r);t=e(),o(n,t)}}},e.ref=function(e){let t=e;const n=new r;return{_isRef:!0,get value(){return n.depend(),t},set value(e){e!==t&&(t=e,n.notify())},toString:()=>t}},e.watchEffect=n,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
