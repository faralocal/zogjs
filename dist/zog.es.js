let e=null;class t{constructor(){this.subscribers=/* @__PURE__ */new Set}depend(){e&&this.subscribers.add(e)}notify(){this.subscribers.forEach(e=>e())}}function r(t){e=t,t(),e=null}function n(e){let r=e;const n=new t;return{_isRef:!0,get value(){return n.depend(),r},set value(e){e!==r&&(r=e,n.notify())},toString:()=>r}}function o(e){let t={};const n=(e,r=t)=>{try{const t=Object.keys(r),n=t.map(e=>r[e]&&r[e]._isRef?r[e].value:r[e]);return new Function(...t,`return ${e}`)(...n)}catch(n){return""}},o=(e,i=t)=>{if(e){if(3===e.nodeType){const t=e.textContent;return void(t.match(/{{\s*(.*?)\s*}}/)&&r(()=>{e.textContent=t.replace(/{{\s*(.*?)\s*}}/g,(e,t)=>n(t,i))}))}if(1===e.nodeType){if(e.hasAttribute("z-if")){const t=e.getAttribute("z-if"),o=document.createComment("z-if");e.parentNode.insertBefore(o,e);let s=e.nextElementSibling,c=s&&s.hasAttribute("z-else")?s:null;if(c&&c.remove(),r(()=>{n(t,i)?(document.contains(e)||o.parentNode.insertBefore(e,o),c&&document.contains(c)&&c.remove()):(e.remove(),c&&o.parentNode.insertBefore(c,o))}),!n(t,i))return}if(e.hasAttribute("z-for")){const t=e.getAttribute("z-for"),[c,a]=t.split(" in ").map(e=>e.trim()),u=e.parentNode,l=document.createComment("z-for");u.insertBefore(l,e),e.remove();let f=[];return void r(()=>{f.forEach(e=>e.remove()),f=[];const t=n(a,i);Array.isArray(t)&&t.forEach((t,r)=>{const n=e.cloneNode(!0);n.removeAttribute("z-for"),u.insertBefore(n,l),f.push(n);const a={...i,[c]:{value:t,_isRef:!0},index:r};Array.from(n.childNodes).forEach(e=>o(e,a)),s(n,a)})})}s(e,i),Array.from(e.childNodes).forEach(e=>o(e,i))}}},s=(e,t)=>{Array.from(e.attributes).forEach(o=>{const{name:s,value:i}=o;if("z-model"===s){e.removeAttribute("z-model");const o=e.getAttribute("type"),s=e.tagName.toLowerCase();"checkbox"===o?(e.addEventListener("change",()=>{t[i]&&(t[i].value=e.checked)}),r(()=>e.checked=n(i,t))):"radio"===o?(e.addEventListener("change",()=>{e.checked&&t[i]&&(t[i].value=e.value)}),r(()=>{e.checked=n(i,t)===e.value})):"select"===s?(e.addEventListener("change",e=>{t[i]&&(t[i].value=e.target.value)}),r(()=>e.value=n(i,t))):(e.addEventListener("input",e=>{t[i]&&(t[i].value=e.target.value)}),r(()=>{e.value=n(i,t)}))}if(s.startsWith("@")){const r=s.slice(1);e.removeAttribute(s);const o=e=>{const r=t[i];"function"==typeof r?r(e):n(i,t)};e.addEventListener(r,o)}if(s.startsWith(":")){const o=s.slice(1);e.removeAttribute(s),r(()=>{const r=n(i,t);if("style"===o&&"object"==typeof r)Object.assign(e.style,r);else if("class"===o&&"object"==typeof r){const t=Object.keys(r).filter(e=>r[e]).join(" ");e.setAttribute("class",t)}else e.setAttribute(o,r)})}"z-text"===s&&(e.removeAttribute("z-text"),r(()=>e.textContent=n(i,t))),"z-html"===s&&(e.removeAttribute("z-html"),r(()=>e.innerHTML=n(i,t))),"z-show"===s&&(e.removeAttribute("z-show"),r(()=>{e.style.display=n(i,t)?"":"none"}))})};return{mount(r){const n=document.querySelector(r);t=e(),o(n,t)}}}export{o as createApp,n as ref,r as watchEffect};
